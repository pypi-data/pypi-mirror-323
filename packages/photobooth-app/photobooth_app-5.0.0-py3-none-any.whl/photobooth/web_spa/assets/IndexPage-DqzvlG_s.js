import{x as G,y as D,z as H,A as F,d as Q,B as I,e as d,C as O,o as K,D as B,E,f as i,g as s,s as m,n as u,m as p,F as W,t as S,G as X,H as J,p as c,I as $,l as h,q as L,v as o,J as P,Q as M,h as U,i as Y,a as Z,K as ee,L as z}from"./index-wLdBJhHm.js";import{Q as T}from"./QPageSticky-Ci9jDzTQ.js";import{Q as te}from"./QPage-CR1ozIEq.js";import{Q as ie}from"./QCircularProgress-BZGLyy4b.js";import"./format-CJebrXOQ.js";const ne='<circle cx="12.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="0s" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="52.5" r="12.5" fill-opacity=".5"><animate attributeName="fill-opacity" begin="100ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="300ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="600ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="12.5" r="12.5"><animate attributeName="fill-opacity" begin="800ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="52.5" r="12.5"><animate attributeName="fill-opacity" begin="400ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="12.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="700ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="52.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="500ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="92.5" cy="92.5" r="12.5"><animate attributeName="fill-opacity" begin="200ms" dur="1s" values="1;.2;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',ae=G({name:"QSpinnerGrid",props:D,setup(v){const{cSize:t,classes:e}=H(v);return()=>F("svg",{class:e.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg",innerHTML:ne})}}),se='<g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"></animate><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"></animate></circle></g>',oe=G({name:"QSpinnerPuff",props:D,setup(v){const{cSize:t,classes:e}=H(v);return()=>F("svg",{class:e.value,stroke:"currentColor",width:t.value,height:t.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg",innerHTML:se})}}),re={id:"countdown-timer-container",class:"flex flex-center",style:{width:"70vw",height:"70vh"}},ce=["innerHTML"],le={style:{height:"100%"}},ue=Q({__name:"CountdownTimer",props:{duration:{},messageDuration:{default:.5},messageText:{default:"ðŸ˜ƒ"}},setup(v){let t;const e=I(0),g=I(0),l=v,_=d(()=>e.value>0),r=d(()=>e.value>0),f=d(()=>e.value<=l.messageDuration);O(()=>{w()}),K(()=>{b()});const b=()=>{clearInterval(t),e.value=0},w=()=>{g.value=l.duration,e.value=g.value,console.log(`starting timer, duration=${g.value}`),t=window.setInterval(()=>{e.value-=.05,e.value<=0&&clearInterval(t)},50)};return(k,q)=>B((i(),s("div",re,[B(m("div",{id:"countdown-timer-message",style:{position:"absolute","font-size":"150px"},innerHTML:k.messageText},null,8,ce),[[E,f.value]]),m("div",le,[B(u(ie,{"show-value":!f.value,style:{width:"100%",height:"100%"},value:e.value,min:0,max:g.value,reverse:"","animation-speed":"100","font-size":"0.5em",size:"70vh",color:"primary",class:"text-secondary"},{default:p(()=>[W(S(parseFloat(e.value.toFixed(0))),1)]),_:1},8,["show-value","value","max"]),[[E,r.value]])])],512)),[[E,_.value]])}}),de={class:"row q-gutter-md action-buttons"},me={style:{"white-space":"nowrap"},class:"gt-sm"},ge=Q({__name:"FrontpageTriggerButtons",props:{triggers:{}},emits:["triggerAction"],setup(v,{emit:t}){const e=t;function g(l,_){e("triggerAction",l,_)}return(l,_)=>(i(),s("div",de,[(i(!0),s(X,null,J(l.triggers,(r,f)=>(i(),s("div",{key:f},[r.show_button&&!(c($.isEmpty)(r.title)&&c($.isEmpty)(r.icon))?(i(),h(M,{key:0,stack:"",color:"primary","no-caps":"",rounded:"",class:P(["action-button col-auto glass-effect",["action-button-"+f]]),onClick:b=>g(r.action,r.config_index)},{default:p(()=>[c($.isEmpty)(r.icon)?o("",!0):(i(),h(L,{key:0,name:`sym_o_${r.icon}`},null,8,["name"])),m("div",me,S(r.title),1)]),_:2},1032,["class","onClick"])):o("",!0)]))),128))]))}}),pe={key:0,id:"v2-preview-blurredback",style:{"background-image":"url('/api/aquisition/stream.mjpg')"}},ve={key:1,id:"v2-overlay-wrapper"},fe=["src"],_e={key:2,id:"v2-stream-wrapper"},he={key:1,class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},ye={key:2,id:"frontpage-countdown",class:"full-height full-width column justify-center content-center",style:{position:"absolute"}},be=["innerHTML"],we={key:0},ke={key:0},Ce={class:"q-gutter-md"},xe={class:"gt-sm"},Te={key:0},Me={class:"q-gutter-md"},Se={class:"gt-sm"},Ie=Q({__name:"IndexPage",setup(v){const t=U(),e=Y(),g=Z(),l=I(0);ee(l,()=>{l.value>=5&&g.push("/admin"),l.value=0},{debounce:500});const _=d(()=>{const a=[];return Object.entries(e.configuration.actions).forEach(([n,x])=>{x.forEach((y,N)=>{const A={action:`actions/${n}`,config_index:N,show_button:y.trigger.ui_trigger.show_button,title:y.trigger.ui_trigger.title,icon:y.trigger.ui_trigger.icon};a.push(A)})}),console.log(a),a}),r=d(()=>{const a=t.state=="capture";return t.state=="captures_completed"||a&&!k.value}),f=d(()=>t.state=="record"),b=d(()=>e.configuration.uisettings.livestream_mirror_effect),w=d(()=>e.configuration.uisettings.admin_button_invisible),k=d(()=>{const a=t.state=="counting",n=t.state=="capture";return t.duration&&t.duration>0&&a||n}),q=d(()=>{const a=e.configuration.uisettings.enable_livestream_when_idle,n=e.configuration.uisettings.enable_livestream_when_active,x=!t.state||t.state=="finished",y=t.state=="record",N=t.state=="counting",A=t.state=="capture";return x&&a||(N||A)&&n||y}),C=d(()=>!t.state||t.state=="finished"),j=()=>{w.value?l.value++:g.push("/admin")},R=(a,n)=>{z(`/api/${a}/${n}`)},V=()=>{z("/api/actions/stop")};return(a,n)=>(i(),h(te,{id:"index-page",class:"q-pa-none column full-height"},{default:p(()=>[q.value?(i(),s("div",{key:0,id:"v2-preview-container",class:P({mirroreffect:b.value})},[c(e).configuration.uisettings.livestream_blurredbackground?(i(),s("div",pe)):o("",!0),c(e).configuration.uisettings.enable_livestream_frameoverlay?(i(),s("div",ve,[m("img",{id:"v2-overlay-image",style:{"background-image":"url('/api/aquisition/stream.mjpg')"},src:c(e).configuration.uisettings.livestream_frameoverlay_image},null,8,fe)])):(i(),s("div",_e,n[1]||(n[1]=[m("img",{id:"v2-stream-image",src:"/api/aquisition/stream.mjpg"},null,-1)])))],2)):o("",!0),r.value?(i(),s("div",he,[u(ae,{size:"20em"})])):o("",!0),k.value?(i(),s("div",ye,[u(ue,{ref:"countdowntimer",duration:c(t).duration,"message-duration":c(e).configuration.uisettings.TAKEPIC_MSG_TIME,"message-text":c(e).configuration.uisettings.TAKEPIC_MSG_TEXT},null,8,["duration","message-duration","message-text"])])):o("",!0),C.value?(i(),s("div",{key:3,id:"frontpage_text",innerHTML:c(e).configuration.uisettings.FRONTPAGE_TEXT},null,8,be)):o("",!0),u(T,{position:"bottom",class:"q-mb-lg"},{default:p(()=>[C.value?(i(),s("div",we,[u(ge,{triggers:_.value,onTriggerAction:R},null,8,["triggers"])])):o("",!0)]),_:1}),u(T,{position:"top-left",class:"q-ma-lg"},{default:p(()=>[C.value?(i(),s("div",ke,[m("div",Ce,[c(e).configuration.uisettings.show_gallery_on_frontpage?(i(),h(M,{key:0,id:"frontpage-button-to-gallery",color:"primary","no-caps":"",rounded:"",to:"/gallery",class:"action-button glass-effect"},{default:p(()=>[u(L,{left:"",name:"sym_o_photo_library"}),m("div",xe,S(a.$t("BTN_LABEL_MAINPAGE_TO_GALLERY")),1)]),_:1})):o("",!0)])])):o("",!0)]),_:1}),u(T,{position:"top-right",class:"q-ma-lg"},{default:p(()=>[C.value?(i(),s("div",Te,[m("div",Me,[c(e).configuration.uisettings.show_admin_on_frontpage?(i(),h(M,{key:0,id:"frontpage-button-to-admin",rounded:"",color:"transparent","no-caps":"",class:P(["action-button action-button-admin glass-effect",{"action-button-admin-invisible":w.value}]),onClick:j},{default:p(()=>[u(L,{left:"",name:"sym_o_admin_panel_settings"}),m("div",Se,S(a.$t("BTN_LABEL_MAINPAGE_TO_ADMIN")),1)]),_:1},8,["class"])):o("",!0)])])):o("",!0)]),_:1}),f.value?(i(),h(T,{key:4,id:"frontpage-indicator-recording",position:"top",offset:[0,25],align:"center"},{default:p(()=>[u(oe,{color:"red",size:"10em"}),n[2]||(n[2]=m("br",null,null,-1)),u(M,{flat:"",color:"red",label:"Stop recording",onClick:n[0]||(n[0]=x=>V())})]),_:1})):o("",!0)]),_:1}))}});export{Ie as default};
